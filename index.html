<meta name="description" content="Pure Drive - VTC Premium Mercedes électrique à Marseille et alentours. Réservation 24h/24 7j/7. Service de chauffeur privé haut de gamme. Aéroport Marseille-Provence, Gare Saint-Charles.">
    <meta name="keywords" content="VTC Marseille, chauffeur privé Marseille, VTC premium Marseille, VTC Mercedes Marseille, VTC électrique Marseille, VTC aéroport Marseille, chauffeur privé Marseille, transport avec chauffeur Marseille, Pure Drive VTC">
    <meta name="author" content="Pure Drive">
    <meta name="robots" content="index, follow">
    <meta name="geo.region" content="FR-PAC">
    <meta name="geo.placename" content="Marseille"><!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 haut de gamme avec chauffeur professionnel. Aéroport Marseille-Provence, Gare Saint-Charles.">
    <meta name="keywords" content="taxi Marseille, taxi premium Marseille, taxi Mercedes Marseille, taxi Tesla Marseille, taxi électrique Marseille, taxi aéroport Marseille, chauffeur privé Marseille, VTC Marseille, taxi gare Saint-Charles, Pure Drive taxi">
    <meta name="author" content="Pure Drive">
    <meta name="robots" content="index, follow">
    <meta name="geo.region" content="FR-PAC">
    <meta name="geo.placename" content="Marseille">
    <meta name="geo.position" content="43.296482;5.36978">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.hbi-service.fr/">
    <meta property="og:title" content="Pure Drive - Taxi Premium Mercedes & Tesla Électrique Marseille">
    <meta property="og:description" content="Service de taxi haut de gamme à Marseille. Mercedes électrique, Tesla électrique, chauffeur professionnel, disponible 24h/24 7j/7">
    <meta property="og:image" content="https://www.hbi-service.fr/images/mercedes-taxi.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.hbi-service.fr/">
    <meta property="twitter:title" content="Pure Drive - Taxi Premium Mercedes & Tesla Électrique Marseille">
    <meta property="twitter:description" content="Service de taxi haut de gamme à Marseille. Mercedes électrique, Tesla électrique, chauffeur professionnel">
    
    <link rel="canonical" href="https://www.hbi-service.fr/">

    <link rel="icon" type="image/png" href="images/logo/favicon.png">
    
    <title>Pure Drive - Taxi Premium Mercedes & Tesla Électrique Marseille | Réservation 24/7</title>
    
    <!-- Schema.org markup for Google -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TaxiService",
        "name": "Pure Drive",
        "description": "Service de taxi premium avec Mercedes & Tesla électrique à Marseille et alentours",
        "url": "https://www.hbi-service.fr",
        "telephone": "+33755662379",
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "Marseille",
            "addressRegion": "Provence-Alpes-Côte d'Azur",
            "addressCountry": "FR"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": 43.296482,
            "longitude": 5.36978
        },
        "areaServed": ["Marseille", "Aix-en-Provence", "Aubagne", "La Ciotat", "Cassis"],
        "priceRange": "€€€",
        "openingHoursSpecification": {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
            "opens": "00:00",
            "closes": "23:59"
        }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gold: #D4AF37;
            --dark-bg: #0a0a0a;
            --light-text: #ffffff;
            --gray-text: #888888;
            --accent-dark: #1a1a1a;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--dark-bg);
            color: var(--light-text);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Header animé */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 10px 0;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            height: 160px;
            width: auto;
            display: flex;
            align-items: center;
            transition: height 0.3s ease;
        }

        .logo img {
            height: 150%;
            width: auto;
        }

        /* Menu de navigation */
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-menu a {
            color: var(--light-text);
            text-decoration: none;
            transition: color 0.3s ease;
            font-weight: 500;
        }

        .nav-menu a:hover {
            color: var(--primary-gold);
        }

        .menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--primary-gold);
            margin: 3px 0;
            transition: 0.3s;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            position: relative;
            overflow: hidden;
            padding-top: 180px; /* Espace pour le header fixe plus grand */
        }

        .hero::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(212, 175, 55, 0.03) 10px,
                rgba(212, 175, 55, 0.03) 20px
            );
            animation: slide 20s linear infinite;
        }

        @keyframes slide {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .hero-content {
            text-align: center;
            z-index: 1;
            animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero h1 {
            font-size: clamp(36px, 5vw, 60px);
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--primary-gold), #f4e5c2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .hero p {
            font-size: clamp(18px, 3vw, 24px);
            color: var(--gray-text);
            margin-bottom: 40px;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 18px 40px;
            font-size: 18px;
            text-decoration: none;
            border-radius: 50px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: none;
        }

        .btn-primary {
            background: var(--primary-gold);
            color: var(--dark-bg);
            font-weight: bold;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary-gold);
            border: 2px solid var(--primary-gold);
        }

        .btn-secondary:hover {
            background: var(--primary-gold);
            color: var(--dark-bg);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
        }

        /* About Section (Chauffeur & Véhicule) */
        .about {
            padding: 100px 0;
            background: var(--accent-dark);
            scroll-margin-top: 80px; /* Compensation pour le header fixe */
        }

        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            margin-top: 60px;
        }

        .about-text h3 {
            font-size: 36px;
            color: var(--primary-gold);
            margin-bottom: 20px;
        }

        .about-text p {
            color: var(--gray-text);
            margin-bottom: 20px;
            font-size: 18px;
        }

        .features-list {
            list-style: none;
            margin-top: 30px;
        }

        .features-list li {
            color: var(--light-text);
            margin-bottom: 15px;
            padding-left: 30px;
            position: relative;
            font-size: 16px;
        }

        .features-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--primary-gold);
            font-weight: bold;
            font-size: 20px;
        }

        .vehicle-specs {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .vehicle-specs:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.1);
        }

        .vehicle-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .specs-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .vehicles-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 40px;
        }
        .spec-item {
            text-align: center;
        }

        .spec-item .value {
            font-size: 24px;
            color: var(--primary-gold);
            font-weight: bold;
            display: block;
        }

        .spec-item .label {
            color: var(--gray-text);
            font-size: 14px;
            margin-top: 5px;
        }

        /* Services Section */
        .services {
            padding: 100px 0;
            background: var(--dark-bg);
            scroll-margin-top: 80px; /* Compensation pour le header fixe */
        }

        .section-title {
            text-align: center;
            font-size: clamp(32px, 4vw, 48px);
            margin-bottom: 60px;
            color: var(--primary-gold);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
        }

        .service-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .service-card:hover::before {
            opacity: 1;
        }

        .service-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary-gold);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.2);
        }

        .service-icon {
            font-size: 60px;
            margin-bottom: 20px;
            color: var(--primary-gold);
        }

        .service-card h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--light-text);
        }

        .service-card p {
            color: var(--gray-text);
            line-height: 1.6;
        }

        /* Contact Section */
        .contact {
            padding: 100px 0;
            background: var(--accent-dark);
            scroll-margin-top: 80px; /* Compensation pour le header fixe */
        }

        /* Testimonials Section */
        .testimonials {
            padding: 100px 0;
            background: var(--dark-bg);
            scroll-margin-top: 80px;
        }

        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .testimonial-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .testimonial-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-gold);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.1);
        }

        .testimonial-card .stars {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--primary-gold);
        }

        .testimonial-card p {
            color: var(--gray-text);
            font-style: italic;
            line-height: 1.8;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .testimonial-card .author {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .testimonial-card .author strong {
            color: var(--primary-gold);
            font-size: 18px;
        }

        .testimonial-card .author span {
            color: var(--gray-text);
            font-size: 14px;
        }

        /* Pricing Section */
        .pricing {
            padding: 100px 0;
            background: var(--accent-dark);
            scroll-margin-top: 80px;
        }

        .pricing-subtitle {
            text-align: center;
            color: var(--gray-text);
            font-size: 20px;
            margin-bottom: 60px;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .pricing-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 40px;
            border-radius: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .pricing-card.featured {
            border-color: var(--primary-gold);
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.2);
        }

        .pricing-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-gold);
        }

        .pricing-card.featured:hover {
            transform: scale(1.05) translateY(-5px);
        }

        .pricing-card .badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-gold);
            color: var(--dark-bg);
            padding: 5px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .pricing-card h3 {
            font-size: 28px;
            color: var(--primary-gold);
            margin-bottom: 30px;
            text-align: center;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
            margin-bottom: 10px;
        }

        .price-item .route {
            color: var(--light-text);
            font-size: 16px;
        }

        .price-item .price {
            color: var(--primary-gold);
            font-size: 20px;
            font-weight: bold;
        }

        .price-features {
            list-style: none;
            margin-top: 30px;
        }

        .price-features li {
            color: var(--gray-text);
            padding: 10px 0;
            font-size: 15px;
        }

        .pricing-note {
            text-align: center;
            color: var(--gray-text);
            font-size: 14px;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(212, 175, 55, 0.05);
            border-radius: 10px;
        }

        .contact-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: start;
        }

        .contact-info h3 {
            font-size: 36px;
            margin-bottom: 30px;
            color: var(--primary-gold);
        }

        .contact-item {
            margin-bottom: 25px;
            font-size: 18px;
            color: var(--gray-text);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .contact-item span {
            color: var(--primary-gold);
            font-size: 24px;
        }

        .contact-item a {
            color: var(--light-text);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .contact-item a:hover {
            color: var(--primary-gold);
        }

        .booking-form {
            background: rgba(255, 255, 255, 0.02);
            padding: 40px;
            border-radius: 20px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .driver-selection {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .driver-card {
            position: relative;
        }

        .driver-card input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .driver-card label {
            display: block;
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            background: rgba(255, 255, 255, 0.03);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .driver-card label strong {
            display: block;
            font-size: 18px;
            color: var(--light-text);
        }

        .driver-card label span {
            display: block;
            margin-top: 6px;
            color: var(--gray-text);
            font-size: 14px;
        }

        .driver-card input:checked + label {
            border-color: var(--primary-gold);
            background: rgba(212, 175, 55, 0.12);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }

        .calendar-status {
            margin: 15px 0 25px 0;
            padding: 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(212, 175, 55, 0.2);
            color: var(--gray-text);
            font-size: 14px;
        }

        .calendar-status strong {
            color: var(--primary-gold);
        }

        .calendar-status.available {
            border-color: rgba(76, 175, 80, 0.4);
            background: rgba(76, 175, 80, 0.12);
            color: #b4ffce;
        }

        .calendar-status.unavailable {
            border-color: rgba(244, 67, 54, 0.4);
            background: rgba(244, 67, 54, 0.12);
            color: #ffb4a9;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-gold);
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 10px;
            color: var(--light-text);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input[readonly] {
            opacity: 0.75;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }

        .pricing-summary {
            margin: 20px 0;
            padding: 20px;
            border-radius: 15px;
            background: rgba(212, 175, 55, 0.08);
            border: 1px solid rgba(212, 175, 55, 0.2);
            color: var(--light-text);
        }

        .pricing-summary h4 {
            margin-bottom: 10px;
            color: var(--primary-gold);
            font-size: 18px;
        }

        .pricing-summary p {
            margin-bottom: 6px;
            font-size: 15px;
        }

        .payment-section {
            margin-top: 25px;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .payment-section h4 {
            margin-bottom: 15px;
            color: var(--primary-gold);
            font-size: 18px;
        }

        .payment-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 20px;
        }

        .payment-grid .form-group {
            margin-bottom: 0;
        }

        .payment-disclaimer {
            margin-top: 15px;
            font-size: 13px;
            color: var(--gray-text);
        }

        .form-note {
            color: var(--gray-text);
            font-size: 14px;
            margin-bottom: 20px;
            text-align: center;
        }

        /* Footer */
        footer {
            padding: 40px 0;
            background: var(--dark-bg);
            text-align: center;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
        }

        .footer-content p {
            color: var(--gray-text);
            margin-bottom: 10px;
        }

        .electric-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding: 10px 20px;
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--primary-gold);
            border-radius: 30px;
            color: var(--primary-gold);
            font-weight: bold;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo {
                height: 120px;
            }

            .driver-selection,
            .payment-grid {
                grid-template-columns: 1fr;
            }

            .nav-menu {
                position: fixed;
                left: -100%;
                top: 140px;
                flex-direction: column;
                background-color: var(--dark-bg);
                width: 100%;
                text-align: center;
                transition: 0.3s;
                padding: 20px;
                border-top: 1px solid var(--primary-gold);
            }

            .nav-menu.active {
                left: 0;
            }

            .menu-toggle {
                display: flex;
            }

            .hero h1 {
                font-size: 36px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .about-content,
            .contact-content {
                grid-template-columns: 1fr;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 250px;
            }

            .section-title {
                font-size: 32px;
            }

            .about-text {
                text-align: center;
            }

            .features-list {
                text-align: left;
                max-width: 300px;
                margin: 30px auto 0;
            }

            .specs-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations supplémentaires */
        .float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Zone de service spécifique pour SEO */
        .service-areas {
            background: rgba(212, 175, 55, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .service-areas h4 {
            color: var(--primary-gold);
            margin-bottom: 15px;
        }

        .areas-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .areas-list span {
            background: rgba(212, 175, 55, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            color: var(--light-text);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <img src="images/logo/logo.png" alt="Pure Drive Logo" />
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="#home">Accueil</a></li>
                    <li><a href="#about">Notre Service</a></li>
                    <li><a href="#services">Prestations</a></li>
                    <li><a href="#testimonials">Avis Clients</a></li>
                    <li><a href="#pricing">Tarifs</a></li>
                    <li><a href="#booking">Réservation</a></li>
                </ul>
                <div class="menu-toggle" id="menuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Pure Drive - Taxi Premium Marseille</h1>
            <p>Vos Chauffeurs Privés en véhicules électriques</p>
            <div class="electric-badge float">
                ⚡  Mercedes EQA 250+ & Tesla Model 3 - 100% électriques
            </div>
            <div class="cta-buttons" style="margin-top: 40px;">
                <a href="tel:+33755662379" class="btn btn-primary">
                    📞 Appeler Maintenant
                </a>
                <a href="#booking" class="btn btn-secondary">
                    📅 Réserver en Ligne
                </a>
            </div>
        </div>
    </section>

    <section class="about" id="about">
        <div class="container">
            <h2 class="section-title">Nos Chauffeurs & Véhicules Premium</h2>
            <div class="about-content">
                <div class="about-text">
                    <h3>Chauffeur Professionnel Expérimenté</h3>
                    <p>
                        Avec plus de 15 ans d'expérience dans le transport de personnes à Marseille, Hamid et Stéphane vous garantissent un service d'excellence. Ponctuels, discrets et courtois, ils connaissent parfaitement Marseille et sa région pour vous conduire en toute sérénité.
                    </p>
                    <p>
                        Formés aux dernières normes de sécurité et de conduite écologique, ils roulent 100% électrique : Hamid en Mercedes EQA 250+ et Stéphane en Tesla Model 3. Ils s'engagent à vous offrir des trajets confortables et respectueux de l'environnement.
                    </p>
                    <ul class="features-list">
                        <li>Chauffeur diplômé et carte professionnelle VTC</li>
                        <li>Parfaite connaissance de Marseille et sa région</li>
                        <li>Multilingue : Français, Anglais, Espagnol, Arabe</li>
                        <li>Discrétion et confidentialité assurées</li>
                        <li>Assistance bagages et service personnalisé</li>
                    </ul>
            </div>

                <div class="vehicles-grid">
                    <div class="vehicle-specs">
                        <div class="vehicle-icon">🚗</div>
                        <h3>Tesla Model 3</h3>
                        <p>Conduite par Stéphane</p>
                        <div class="specs-grid">
                            <div class="spec-item">
                                <span class="value">0</span>
                                <span class="label">Émission CO2</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">440km</span>
                                <span class="label">Autonomie</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">4</span>
                                <span class="label">Places confort</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">Premium</span>
                                <span class="label">Intérieur cuir</span>
                            </div>
                        </div>
                    </div>
                    <div class="vehicle-specs">
                        <div class="vehicle-icon">🚗</div>
                        <h3>Mercedes EQA 250+</h3>
                        <p>Conduite par Hamid</p>
                        <div class="specs-grid">
                            <div class="spec-item">
                                <span class="value">0</span>
                                <span class="label">Émission CO2</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">430km</span>
                                <span class="label">Autonomie</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">4</span>
                                <span class="label">Places confort</span>
                            </div>
                            <div class="spec-item">
                                <span class="value">Premium</span>
                                <span class="label">Intérieur cuir</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="services" id="services">
        <div class="container">
            <h2 class="section-title">Nos Services de Taxi Premium à Marseille</h2>
            <div class="services-grid">
                <article class="service-card">
                    <div class="service-icon">✈️</div>
                    <h3>Transfert Aéroport Marseille-Provence</h3>
                    <p>Service de navette premium vers et depuis l'aéroport de Marignane. Ponctualité garantie et suivi des vols en temps réel.</p>
                </article>
                <article class="service-card">
                    <div class="service-icon">🚉</div>
                    <h3>Gare Saint-Charles & TGV</h3>
                    <p>Transferts directs vers la gare Saint-Charles et la gare TGV d'Aix-en-Provence. Service porte à porte avec assistance bagages.</p>
                </article>
                <article class="service-card">
                    <div class="service-icon">💼</div>
                    <h3>Déplacements Professionnels</h3>
                    <p>Transport d'affaires discret et ponctuel. Wifi à bord, chargeurs USB, journaux du jour. Facturation entreprise disponible.</p>
                </article>
                <article class="service-card">
                    <div class="service-icon">🌊</div>
                    <h3>Tourisme & Excursions</h3>
                    <p>Découvrez les Calanques, Cassis, Aix-en-Provence avec un chauffeur-guide. Circuits personnalisés sur demande.</p>
                </article>
                <article class="service-card">
                    <div class="service-icon">🏥</div>
                    <h3>Transport Médical</h3>
                    <p>Service adapté pour vos rendez-vous médicaux. Véhicule spacieux et confortable, accompagnement personnalisé.</p>
                </article>
                <article class="service-card">
                    <div class="service-icon">🎭</div>
                    <h3>Événements & Soirées</h3>
                    <p>Mariages, soirées, événements sportifs au Stade Vélodrome. Service premium pour vos occasions spéciales.</p>
                </article>
            </div>
        </div>
    </section>

    <!-- Section Témoignages -->
    <section class="testimonials" id="testimonials">
        <div class="container">
            <h2 class="section-title">Ce que disent nos clients</h2>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"Service impeccable ! Ponctualité, véhicule luxueux et propre, chauffeur très professionnel. Je recommande vivement pour vos déplacements sur Marseille."</p>
                    <div class="author">
                        <strong>Marie L.</strong>
                        <span>Cliente régulière</span>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"Transfert aéroport parfait. Le chauffeur m'attendait malgré le retard de mon vol. La Mercedes électrique est un vrai plaisir, silencieuse et confortable."</p>
                    <div class="author">
                        <strong>Pierre D.</strong>
                        <span>Voyageur d'affaires</span>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"J'utilise Pure Drive pour tous mes rendez-vous professionnels. Toujours à l'heure, discret et le wifi dans la voiture me permet de travailler pendant le trajet."</p>
                    <div class="author">
                        <strong>Sophie M.</strong>
                        <span>Directrice commerciale</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Tarifs -->
    <section class="pricing" id="pricing">
        <div class="container">
            <h2 class="section-title">Tarifs Indicatifs</h2>
            <p class="pricing-subtitle">Tarifs transparents et sans surprise</p>
            <div class="pricing-grid">
                <div class="pricing-card">
                    <h3>Transferts Aéroport</h3>
                    <div class="price-item">
                        <span class="route">Marseille Centre ↔ Aéroport</span>
                        <span class="price">À partir de 65€</span>
                    </div>
                    <div class="price-item">
                        <span class="route">Aix-en-Provence ↔ Aéroport</span>
                        <span class="price">À partir de 55€</span>
                    </div>
                    <ul class="price-features">
                        <li>✓ Attente gratuite 45min</li>
                        <li>✓ Suivi des vols</li>
                        <li>✓ Aide aux bagages</li>
                    </ul>
                </div>
                <div class="pricing-card featured">
                    <div class="badge">Plus populaire</div>
                    <h3>Mise à Disposition</h3>
                    <div class="price-item">
                        <span class="route">Demi-journée (4h)</span>
                        <span class="price">À partir de 280€</span>
                    </div>
                    <div class="price-item">
                        <span class="route">Journée complète (8h)</span>
                        <span class="price">À partir de 480€</span>
                    </div>
                    <ul class="price-features">
                        <li>✓ Kilométrage illimité en ville</li>
                        <li>✓ Attente incluse</li>
                        <li>✓ Flexibilité totale</li>
                    </ul>
                </div>
                <div class="pricing-card">
                    <h3>Courses en Ville</h3>
                    <div class="price-item">
                        <span class="route">Prise en charge</span>
                        <span class="price">8€</span>
                    </div>
                    <div class="price-item">
                        <span class="route">Tarif au km</span>
                        <span class="price">2.50€/km</span>
                    </div>
                    <ul class="price-features">
                        <li>✓ Minimum de course : 25€</li>
                        <li>✓ Majoration nuit : +20%</li>
                        <li>✓ Devis gratuit</li>
                    </ul>
                </div>
            </div>
            <p class="pricing-note">
                <em>Ces tarifs sont indicatifs et peuvent varier selon la distance exacte, l'heure et les conditions de circulation. 
                Demandez un devis personnalisé pour votre trajet.</em>
            </p>
        </div>
    </section>

    <section class="contact" id="booking">
        <div class="container">
            <h2 class="section-title">Réservez Votre Taxi Premium à Marseille</h2>
            <div class="contact-content">
                <div class="contact-info">
                    <h3>Contact Direct 24h/24 7j/7</h3>
                    <div class="contact-item">
                        <span>📞</span>
                        <div>
                            <strong>Téléphone:</strong><br>
                            <a href="tel:+33755662379">+33 7 55 66 23 79</a>
                        </div>
                    </div>
                    <div class="contact-item">
                        <span>📧</span>
                        <div>
                            <strong>Email:</strong><br>
                            <a href="mailto:hbisservices@gmail.com">hbisservices@gmail.com</a>
                        </div>
                    </div>
                    <div class="contact-item">
                        <span>📍</span>
                        <div>
                            <strong>Siège:</strong><br>
                            Marseille
                        </div>
                    </div>
                    
                    <div class="service-areas">
                        <h4>Zones desservies:</h4>
                        <div class="areas-list">
                            <span>Marseille Centre</span>
                            <span>Vieux-Port</span>
                            <span>La Canebière</span>
                            <span>Castellane</span>
                            <span>Prado</span>
                            <span>Aéroport Marignane</span>
                            <span>Aix-en-Provence</span>
                            <span>Aubagne</span>
                            <span>Cassis</span>
                            <span>La Ciotat</span>
                            <span>Plan de Campagne</span>
                            <span>Vitrolles</span>
                            <span>Côte Bleue</span>
                            <span>Martigues</span>
                        </div>
                    </div>
                </div>
                
                <div class="booking-form">
                    <form action="#" method="post" id="reservationForm">
                        <div class="form-note">
                            ⚠️ Réservation minimum 24h à l'avance<br>
                            Pour une course immédiate, appelez-nous directement
                        </div>

                        <div class="form-group">
                            <label>Choix du chauffeur & véhicule *</label>
                            <div class="driver-selection">
                                <div class="driver-card">
                                    <input type="radio" id="driver-stephane" name="driver" value="stephane" required>
                                    <label for="driver-stephane">
                                        <strong>Stéphane</strong>
                                        <span>Tesla Model 3 Grande Autonomie</span>
                                    </label>
                                </div>
                                <div class="driver-card">
                                    <input type="radio" id="driver-hamid" name="driver" value="hamid" required>
                                    <label for="driver-hamid">
                                        <strong>Hamid</strong>
                                        <span>Mercedes Classe E 300e</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div id="calendarStatus" class="calendar-status">
                            Sélectionnez un chauffeur puis une date de prise en charge pour vérifier sa disponibilité.
                        </div>

                        <div class="form-group">
                            <label for="name">Nom & Prénom *</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="phone">Téléphone *</label>
                            <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email">
                        </div>
                        
                        <div class="form-group">
                            <label for="pickup">Lieu de prise en charge *</label>
                            <input type="text" id="pickup" name="pickup" placeholder="Ex: 25 Rue de la République, Marseille" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="dropoff">Lieu de dépose *</label>
                            <input type="text" id="dropoff" name="dropoff" placeholder="Ex: Aéroport Marseille-Provence" required>
                        </div>

                        <div class="form-group">
                            <label for="distance">Distance estimée (km)</label>
                            <input type="text" id="distance" name="distance" placeholder="En attente du calcul..." readonly>
                            <input type="hidden" id="distanceMeters" name="distanceMeters">
                        </div>

                        <div class="form-group">
                            <label for="duration">Durée estimée</label>
                            <input type="text" id="duration" name="duration" placeholder="En attente du calcul..." readonly>
                            <input type="hidden" id="durationSeconds" name="durationSeconds">
                        </div>

                        <div class="form-group">
                            <label for="date">Date & Heure *</label>
                            <input type="datetime-local" id="date" name="date" required>
                        </div>

                        <div class="form-group">
                            <label for="passengers">Nombre de passagers</label>
                            <select id="passengers" name="passengers">
                                <option value="1">1 passager</option>
                                <option value="2">2 passagers</option>
                                <option value="3">3 passagers</option>
                                <option value="4">4 passagers</option>
                            </select>
                        </div>

                        <div class="pricing-summary" id="pricingSummary">
                            <h4>Résumé tarifaire estimatif</h4>
                            <p><strong>Créneau horaire :</strong> <span id="pricingSlot">--</span></p>
                            <p><strong>Tarif kilométrique :</strong> <span id="pricingPerKm">--</span></p>
                            <p><strong>Distance estimée :</strong> <span id="pricingDistance">--</span></p>
                            <p><strong>Total prévisionnel :</strong> <span id="pricingTotal">--</span></p>
                        </div>

                        <div class="payment-section">
                            <h4>Paiement sécurisé par carte bleue</h4>
                            <div class="payment-grid">
                                <div class="form-group">
                                    <label for="cardHolder">Titulaire de la carte *</label>
                                    <input type="text" id="cardHolder" name="cardHolder" autocomplete="cc-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="cardNumber">Numéro de carte *</label>
                                    <input type="text" id="cardNumber" name="cardNumber" inputmode="numeric" autocomplete="cc-number" placeholder="4242 4242 4242 4242" required>
                                </div>
                                <div class="form-group">
                                    <label for="cardExpiry">Date d'expiration (MM/AA) *</label>
                                    <input type="text" id="cardExpiry" name="cardExpiry" inputmode="numeric" autocomplete="cc-exp" placeholder="07/27" required>
                                </div>
                                <div class="form-group">
                                    <label for="cardCvc">Cryptogramme (CVC) *</label>
                                    <input type="text" id="cardCvc" name="cardCvc" inputmode="numeric" autocomplete="cc-csc" placeholder="123" required>
                                </div>
                            </div>
                            <p class="payment-disclaimer">
                                Les informations de carte sont chiffrées et utilisées uniquement pour le paiement immédiat de votre course.
                                Pour la mise en production, renseignez vos clés Stripe ou tout autre PSP compatible.
                            </p>
                        </div>

                        <div class="form-group">
                            <label for="message">Message complémentaire</label>
                            <input type="text" id="message" name="message" placeholder="Précisions, demandes particulières...">
                        </div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            Confirmer la Réservation
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <p><strong>Pure Drive</strong> - Le taxi électrique de prestige</p>
                <p>SIRET: XXX XXX XXX XXXXX | Licence VTC: XXXXXXXXX</p>
                <p>&copy; 2024 Pure Drive- Tous droits réservés</p>
                <div class="electric-badge">
                    ⚡ Service 100% Électrique - Mercedes EQA 250+ & Tesla Model 3
                </div>
            </div>
        </div>
    </footer>

    <script>
        const GOOGLE_MAPS_API_KEY = 'YOUR_GOOGLE_MAPS_API_KEY';
        const DEFAULT_SERVICE_MINUTES = 90;
        const SAFETY_BUFFER_MINUTES = 20;
        const WEEKEND_MULTIPLIER = 1.15;
        const LATE_NIGHT_MULTIPLIER = 1.1;
        const pricingRules = [
            { label: 'Heures de jour (06h00 - 20h00)', startHour: 6, endHour: 20, base: 18, perKm: 1.8 },
            { label: 'Soirée (20h00 - 00h00)', startHour: 20, endHour: 24, base: 22, perKm: 2.1 },
            { label: 'Nuit (00h00 - 06h00)', startHour: 0, endHour: 6, base: 25, perKm: 2.4 }
        ];
        const currencyFormatter = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' });

        function generateBusySlots(presets) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            return presets.map(({ daysFromNow, startHour, startMinute = 0, durationMinutes = DEFAULT_SERVICE_MINUTES, summary = 'Course confirmée' }) => {
                const start = new Date(today);
                start.setDate(start.getDate() + daysFromNow);
                start.setHours(startHour, startMinute, 0, 0);
                const end = new Date(start.getTime() + durationMinutes * 60000);
                return { start, end, summary };
            });
        }

        const driverCalendars = {
            stephane: {
                name: 'Stéphane',
                vehicle: 'Tesla Model 3 Grande Autonomie',
                busySlots: generateBusySlots([
                    { daysFromNow: 1, startHour: 9, durationMinutes: 120, summary: 'Transfert entreprise' },
                    { daysFromNow: 2, startHour: 14, durationMinutes: 90, summary: 'Circuit touristique' },
                    { daysFromNow: 4, startHour: 7, durationMinutes: 150, summary: 'Navette aéroport' }
                ]),
                icsUrls: []
            },
            hamid: {
                name: 'Hamid',
                vehicle: 'Mercedes Classe E 300e',
                busySlots: generateBusySlots([
                    { daysFromNow: 0, startHour: 16, durationMinutes: 120, summary: 'Course événementielle' },
                    { daysFromNow: 3, startHour: 10, durationMinutes: 180, summary: 'Séminaire entreprise' },
                    { daysFromNow: 5, startHour: 6, durationMinutes: 90, summary: 'Navette gare' }
                ]),
                icsUrls: []
            }
        };

        const reservationForm = document.getElementById('reservationForm');
        const pickupInput = document.getElementById('pickup');
        const dropoffInput = document.getElementById('dropoff');
        const distanceField = document.getElementById('distance');
        const distanceMetersField = document.getElementById('distanceMeters');
        const durationField = document.getElementById('duration');
        const durationSecondsField = document.getElementById('durationSeconds');
        const dateField = document.getElementById('date');
        const calendarStatus = document.getElementById('calendarStatus');
        const driverRadios = Array.from(document.querySelectorAll('input[name="driver"]'));
        const pricingSlot = document.getElementById('pricingSlot');
        const pricingPerKm = document.getElementById('pricingPerKm');
        const pricingDistance = document.getElementById('pricingDistance');
        const pricingTotal = document.getElementById('pricingTotal');
        const cardHolderInput = document.getElementById('cardHolder');
        const cardNumberInput = document.getElementById('cardNumber');
        const cardExpiryInput = document.getElementById('cardExpiry');
        const cardCvcInput = document.getElementById('cardCvc');

        let googleMapsReady = false;
        let distanceMatrixService = null;
        let pickupLocation = null;
        let dropoffLocation = null;
        let currentPricing = { total: null, rule: null, distanceKm: null, weekend: false };

        async function syncDriverCalendars() {
            const driverEntries = Object.entries(driverCalendars);
            await Promise.all(driverEntries.map(async ([driverId, driver]) => {
                driver.externalBusySlots = [];
                if (!driver.icsUrls || driver.icsUrls.length === 0) {
                    return;
                }
                for (const url of driver.icsUrls) {
                    try {
                        const response = await fetch(url);
                        if (!response.ok) {
                            console.warn('Impossible de récupérer le calendrier de', driver.name, url);
                            continue;
                        }
                        const icsData = await response.text();
                        const events = parseICS(icsData);
                        driver.externalBusySlots.push(...events);
                    } catch (error) {
                        console.warn('Erreur lors de la synchronisation du calendrier pour', driver.name, error);
                    }
                }
            }));
            updateCalendarStatus();
        }

        function parseICS(icsText) {
            const events = [];
            const lines = icsText.split(/\r?\n/);
            let currentEvent = null;
            lines.forEach(line => {
                if (line.startsWith('BEGIN:VEVENT')) {
                    currentEvent = {};
                } else if (line.startsWith('END:VEVENT')) {
                    if (currentEvent && currentEvent.start && currentEvent.end) {
                        events.push({
                            start: currentEvent.start,
                            end: currentEvent.end,
                            summary: currentEvent.summary || 'Événement externe'
                        });
                    }
                    currentEvent = null;
                } else if (currentEvent) {
                    if (line.startsWith('DTSTART')) {
                        currentEvent.start = parseICSDate(line.split(':').slice(1).join(':'));
                    } else if (line.startsWith('DTEND')) {
                        currentEvent.end = parseICSDate(line.split(':').slice(1).join(':'));
                    } else if (line.startsWith('SUMMARY')) {
                        currentEvent.summary = line.split(':').slice(1).join(':');
                    }
                }
            });
            return events.filter(event => event.start && event.end);
        }

        function parseICSDate(value) {
            if (!value) return null;
            if (value.endsWith('Z')) {
                return new Date(value);
            }
            if (/^\d{8}T\d{6}$/.test(value)) {
                const year = Number(value.slice(0, 4));
                const month = Number(value.slice(4, 6)) - 1;
                const day = Number(value.slice(6, 8));
                const hour = Number(value.slice(9, 11));
                const minute = Number(value.slice(11, 13));
                const second = Number(value.slice(13, 15));
                return new Date(year, month, day, hour, minute, second);
            }
            if (/^\d{8}$/.test(value)) {
                const year = Number(value.slice(0, 4));
                const month = Number(value.slice(4, 6)) - 1;
                const day = Number(value.slice(6, 8));
                return new Date(year, month, day);
            }
            return new Date(value);
        }

        function getDriverBusySlots(driverId) {
            const driver = driverCalendars[driverId];
            if (!driver) {
                return [];
            }
            const baseSlots = driver.busySlots ? [...driver.busySlots] : [];
            if (driver.externalBusySlots && driver.externalBusySlots.length > 0) {
                baseSlots.push(...driver.externalBusySlots);
            }
            return baseSlots;
        }

        function getSelectedDriverId() {
            const checked = driverRadios.find(radio => radio.checked);
            return checked ? checked.value : null;
        }

        function formatDateTime(date) {
            return date.toLocaleString('fr-FR', {
                weekday: 'short',
                day: '2-digit',
                month: 'short',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatDateRange(start, end) {
            if (!start || !end) return '';
            const sameDay = start.toDateString() === end.toDateString();
            if (sameDay) {
                const dayPart = start.toLocaleDateString('fr-FR', {
                    weekday: 'short',
                    day: '2-digit',
                    month: 'short'
                });
                const startHour = start.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                const endHour = end.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                return `${dayPart} ${startHour} - ${endHour}`;
            }
            return `${formatDateTime(start)} → ${formatDateTime(end)}`;
        }

        function checkDriverAvailability(driverId, startDate) {
            const driver = driverCalendars[driverId];
            if (!driver || !startDate) {
                return { available: true };
            }

            const busySlots = getDriverBusySlots(driverId);
            const travelDurationMinutes = Math.max(
                DEFAULT_SERVICE_MINUTES,
                Math.ceil((Number(durationSecondsField.value) || 0) / 60) + SAFETY_BUFFER_MINUTES
            );
            const requestedStart = new Date(startDate.getTime());
            const requestedEnd = new Date(requestedStart.getTime() + travelDurationMinutes * 60000);

            for (const slot of busySlots) {
                if (!slot.start || !slot.end) continue;
                if (requestedStart < slot.end && requestedEnd > slot.start) {
                    return {
                        available: false,
                        conflictingSlot: slot,
                        requestedEnd
                    };
                }
            }

            return {
                available: true,
                requestedEnd
            };
        }

        function updateCalendarStatus() {
            if (!calendarStatus) return;
            calendarStatus.classList.remove('available', 'unavailable');
            const driverId = getSelectedDriverId();
            if (!driverId) {
                calendarStatus.textContent = 'Sélectionnez un chauffeur puis une date de prise en charge pour vérifier sa disponibilité.';
                return;
            }
            const driver = driverCalendars[driverId];
            if (!dateField.value) {
                calendarStatus.innerHTML = `<strong>${driver.name}</strong> — en attente de la sélection d\'une date de prise en charge.`;
                return;
            }
            const startDate = new Date(dateField.value);
            if (Number.isNaN(startDate.getTime())) {
                calendarStatus.textContent = 'Veuillez saisir une date de prise en charge valide.';
                return;
            }

            const availability = checkDriverAvailability(driverId, startDate);
            const busySlots = getDriverBusySlots(driverId)
                .filter(slot => slot.start && slot.start >= new Date(Date.now() - 7 * 24 * 60 * 60 * 1000))
                .sort((a, b) => a.start - b.start)
                .slice(0, 3);

            if (availability.available) {
                calendarStatus.classList.add('available');
                calendarStatus.innerHTML = `<strong>${driver.name}</strong> est disponible.<br>Créneau réservé jusqu'à ${formatDateTime(availability.requestedEnd)}.`;
            } else {
                calendarStatus.classList.add('unavailable');
                const conflictRange = formatDateRange(availability.conflictingSlot.start, availability.conflictingSlot.end);
                calendarStatus.innerHTML = `<strong>${driver.name}</strong> est déjà réservé sur le créneau ${conflictRange}.<br>Choisissez un autre horaire ou un autre chauffeur.`;
            }

            if (busySlots.length > 0) {
                const upcoming = busySlots
                    .map(slot => `• ${formatDateRange(slot.start, slot.end)}${slot.summary ? ` – ${slot.summary}` : ''}`)
                    .join('<br>');
                calendarStatus.innerHTML += `<br><br><strong>Prochaines réservations :</strong><br>${upcoming}`;
            }
        }

        function detectPricingRule(date) {
            const hour = date.getHours();
            return pricingRules.find(rule => {
                if (rule.startHour <= rule.endHour) {
                    return hour >= rule.startHour && hour < rule.endHour;
                }
                return hour >= rule.startHour || hour < rule.endHour;
            }) || pricingRules[0];
        }

        function updatePricingSummary() {
            const distanceKm = currentPricing.distanceKm;
            const dateValue = dateField.value;

            if (!distanceKm || !dateValue) {
                pricingSlot.textContent = '--';
                pricingPerKm.textContent = '--';
                pricingDistance.textContent = distanceKm ? `${distanceKm.toFixed(2).replace('.', ',')} km` : '--';
                pricingTotal.textContent = '--';
                currentPricing.total = null;
                return;
            }

            const rideDate = new Date(dateValue);
            if (Number.isNaN(rideDate.getTime())) {
                pricingSlot.textContent = '--';
                pricingPerKm.textContent = '--';
                pricingDistance.textContent = '--';
                pricingTotal.textContent = '--';
                currentPricing.total = null;
                return;
            }

            const rule = detectPricingRule(rideDate);
            const isWeekend = rideDate.getDay() === 0 || rideDate.getDay() === 6;
            let adjustedPerKm = rule.perKm;
            let total = rule.base + distanceKm * adjustedPerKm;

            if (isWeekend) {
                adjustedPerKm *= WEEKEND_MULTIPLIER;
                total *= WEEKEND_MULTIPLIER;
            }

            if (rideDate.getHours() >= 22 || rideDate.getHours() < 5) {
                adjustedPerKm *= LATE_NIGHT_MULTIPLIER;
                total *= LATE_NIGHT_MULTIPLIER;
            }

            total = Math.max(total, 30);

            currentPricing = {
                ...currentPricing,
                rule,
                total,
                distanceKm,
                weekend: isWeekend
            };

            pricingSlot.textContent = `${rule.label}${isWeekend ? ' (week-end)' : ''}`;
            pricingPerKm.textContent = `${adjustedPerKm.toFixed(2).replace('.', ',')} € / km`;
            pricingDistance.textContent = `${distanceKm.toFixed(2).replace('.', ',')} km`;
            pricingTotal.textContent = currencyFormatter.format(total);
        }

        function loadGoogleMapsScript() {
            if (!GOOGLE_MAPS_API_KEY || GOOGLE_MAPS_API_KEY === 'YOUR_GOOGLE_MAPS_API_KEY') {
                distanceField.placeholder = 'Ajoutez votre clé API Google Maps pour calculer automatiquement la distance.';
                durationField.placeholder = 'Ajoutez votre clé API Google Maps pour estimer la durée.';
                console.warn('Configurez GOOGLE_MAPS_API_KEY pour activer le calcul automatique de distance.');
                return;
            }
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places&language=fr&region=FR&callback=initReservationMap`;
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
        }

        function calculateDistance() {
            const pickupValue = pickupInput.value.trim();
            const dropoffValue = dropoffInput.value.trim();
            if (!pickupValue || !dropoffValue) {
                return;
            }
            if (!googleMapsReady || !distanceMatrixService) {
                distanceField.placeholder = 'En attente de l\'initialisation de Google Maps...';
                durationField.placeholder = 'En attente de l\'initialisation de Google Maps...';
                return;
            }

            const origin = pickupLocation || pickupValue;
            const destination = dropoffLocation || dropoffValue;

            distanceMatrixService.getDistanceMatrix({
                origins: [origin],
                destinations: [destination],
                travelMode: google.maps.TravelMode.DRIVING,
                unitSystem: google.maps.UnitSystem.METRIC,
                drivingOptions: {
                    departureTime: dateField.value ? new Date(dateField.value) : new Date(),
                    trafficModel: google.maps.TrafficModel.BEST_GUESS
                }
            }, (response, status) => {
                if (status !== 'OK') {
                    console.error('Erreur Google Distance Matrix:', status, response);
                    distanceField.value = '';
                    distanceField.placeholder = 'Erreur de calcul. Vérifiez les adresses.';
                    durationField.value = '';
                    durationField.placeholder = 'Erreur de calcul.';
                    distanceMetersField.value = '';
                    durationSecondsField.value = '';
                    currentPricing.distanceKm = null;
                    updatePricingSummary();
                    updateCalendarStatus();
                    return;
                }

                const element = response.rows?.[0]?.elements?.[0];
                if (!element || element.status !== 'OK') {
                    distanceField.value = '';
                    distanceField.placeholder = 'Distance indisponible pour cet itinéraire.';
                    durationField.value = '';
                    durationField.placeholder = 'Durée indisponible.';
                    distanceMetersField.value = '';
                    durationSecondsField.value = '';
                    currentPricing.distanceKm = null;
                    updatePricingSummary();
                    updateCalendarStatus();
                    return;
                }

                const distanceMeters = element.distance.value;
                const durationSeconds = element.duration_in_traffic?.value || element.duration.value;
                const distanceKm = distanceMeters / 1000;
                const durationMinutes = Math.round(durationSeconds / 60);

                distanceField.value = distanceKm.toFixed(2).replace('.', ',');
                distanceField.placeholder = '';
                distanceMetersField.value = String(distanceMeters);

                const hours = Math.floor(durationMinutes / 60);
                const minutes = durationMinutes % 60;
                durationField.value = hours > 0 ? `${hours}h${minutes.toString().padStart(2, '0')}` : `${minutes} min`;
                durationField.placeholder = '';
                durationSecondsField.value = String(durationSeconds);

                currentPricing.distanceKm = distanceKm;
                updatePricingSummary();
                updateCalendarStatus();
            });
        }

        window.initReservationMap = function initReservationMap() {
            googleMapsReady = true;
            distanceMatrixService = new google.maps.DistanceMatrixService();
            const autocompleteOptions = {
                componentRestrictions: { country: ['fr'] },
                fields: ['formatted_address', 'geometry']
            };

            const pickupAutocomplete = new google.maps.places.Autocomplete(pickupInput, autocompleteOptions);
            pickupAutocomplete.addListener('place_changed', () => {
                const place = pickupAutocomplete.getPlace();
                pickupLocation = place?.geometry?.location || null;
                if (place?.formatted_address) {
                    pickupInput.value = place.formatted_address;
                }
                calculateDistance();
            });

            const dropoffAutocomplete = new google.maps.places.Autocomplete(dropoffInput, autocompleteOptions);
            dropoffAutocomplete.addListener('place_changed', () => {
                const place = dropoffAutocomplete.getPlace();
                dropoffLocation = place?.geometry?.location || null;
                if (place?.formatted_address) {
                    dropoffInput.value = place.formatted_address;
                }
                calculateDistance();
            });

            if (pickupInput.value && dropoffInput.value) {
                calculateDistance();
            }
        };

        function sanitizeCardNumber(value) {
            return value.replace(/\D/g, '');
        }

        function luhnCheck(number) {
            let sum = 0;
            let shouldDouble = false;
            for (let i = number.length - 1; i >= 0; i -= 1) {
                let digit = parseInt(number.charAt(i), 10);
                if (shouldDouble) {
                    digit *= 2;
                    if (digit > 9) {
                        digit -= 9;
                    }
                }
                sum += digit;
                shouldDouble = !shouldDouble;
            }
            return sum % 10 === 0;
        }

        function validateExpiry(value) {
            const match = /^([0-1]\d)\/(\d{2})$/.exec(value);
            if (!match) return false;
            const month = Number(match[1]);
            const year = Number(match[2]);
            if (month < 1 || month > 12) return false;
            const now = new Date();
            const currentYear = now.getFullYear() % 100;
            const currentMonth = now.getMonth() + 1;
            if (year < currentYear) return false;
            if (year === currentYear && month < currentMonth) return false;
            return true;
        }

        function validateCardData(cardData) {
            if (!cardData.holder) {
                return { valid: false, message: 'Veuillez renseigner le titulaire de la carte.' };
            }
            if (cardData.number.length < 12 || !luhnCheck(cardData.number)) {
                return { valid: false, message: 'Le numéro de carte semble invalide.' };
            }
            if (!validateExpiry(cardData.expiry)) {
                return { valid: false, message: 'La date d\'expiration est invalide ou dépassée.' };
            }
            if (!/^\d{3,4}$/.test(cardData.cvc)) {
                return { valid: false, message: 'Le cryptogramme visuel doit comporter 3 ou 4 chiffres.' };
            }
            return { valid: true };
        }

        async function simulateCardPayment(amount, cardData) {
            await new Promise(resolve => setTimeout(resolve, 1200));
            if (cardData.number === '4000000000000002') {
                return { success: false, message: 'Carte refusée (code test).' };
            }
            const reference = `SIM-${Math.random().toString(36).slice(2, 10).toUpperCase()}`;
            return { success: true, transactionId: reference };
        }

        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');

        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
        });

        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('active');
            });
        });

        window.addEventListener('scroll', function onScroll() {
            const header = document.querySelector('header');
            const logo = document.querySelector('.logo');
            if (window.scrollY > 50) {
                header.style.padding = '5px 0';
                header.style.background = 'rgba(10, 10, 10, 0.98)';
                logo.style.height = '100px';
            } else {
                header.style.padding = '10px 0';
                header.style.background = 'rgba(10, 10, 10, 0.95)';
                logo.style.height = '160px';
            }
        });

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function smoothScroll(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        driverRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                updateCalendarStatus();
            });
        });

        dateField.addEventListener('change', () => {
            if (googleMapsReady) {
                calculateDistance();
            }
            updatePricingSummary();
            updateCalendarStatus();
        });

        pickupInput.addEventListener('blur', calculateDistance);
        dropoffInput.addEventListener('blur', calculateDistance);
        pickupInput.addEventListener('change', calculateDistance);
        dropoffInput.addEventListener('change', calculateDistance);

        cardNumberInput.addEventListener('input', () => {
            const digits = sanitizeCardNumber(cardNumberInput.value).slice(0, 19);
            cardNumberInput.value = digits.replace(/(.{4})/g, '$1 ').trim();
        });

        cardExpiryInput.addEventListener('input', () => {
            const digits = cardExpiryInput.value.replace(/\D/g, '').slice(0, 4);
            cardExpiryInput.value = digits.length > 2 ? `${digits.slice(0, 2)}/${digits.slice(2)}` : digits;
        });

        cardCvcInput.addEventListener('input', () => {
            cardCvcInput.value = cardCvcInput.value.replace(/\D/g, '').slice(0, 4);
        });

        reservationForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            const driverId = getSelectedDriverId();
            if (!driverId) {
                alert('Veuillez sélectionner un chauffeur pour votre course.');
                return;
            }

            if (!dateField.value) {
                alert('Veuillez indiquer une date et une heure de prise en charge.');
                return;
            }

            const pickupDate = new Date(dateField.value);
            if (Number.isNaN(pickupDate.getTime())) {
                alert('La date de prise en charge est invalide.');
                return;
            }

            const now = new Date();
            const hoursDiff = (pickupDate - now) / (1000 * 60 * 60);
            if (hoursDiff < 24) {
                alert('⚠️ La réservation doit être effectuée au moins 24h à l\'avance.\n\nPour une course immédiate, veuillez nous appeler directement au +33 7 55 66 23 79.');
                return;
            }

            const availability = checkDriverAvailability(driverId, pickupDate);
            if (!availability.available) {
                const conflictRange = formatDateRange(availability.conflictingSlot.start, availability.conflictingSlot.end);
                alert(`Le chauffeur ${driverCalendars[driverId].name} est indisponible sur ce créneau (${conflictRange}).\nMerci de sélectionner un autre horaire ou un autre chauffeur.`);
                return;
            }

            if (!currentPricing.total) {
                alert('Le calcul du tarif est en cours. Veuillez patienter quelques instants.');
                return;
            }

            const cardData = {
                holder: cardHolderInput.value.trim(),
                number: sanitizeCardNumber(cardNumberInput.value),
                expiry: cardExpiryInput.value.trim(),
                cvc: cardCvcInput.value.trim()
            };

            const cardValidation = validateCardData(cardData);
            if (!cardValidation.valid) {
                alert(cardValidation.message);
                return;
            }

            const paymentResult = await simulateCardPayment(currentPricing.total, cardData);
            if (!paymentResult.success) {
                alert(`Le paiement a été refusé : ${paymentResult.message}`);
                return;
            }

            alert(`✅ Paiement confirmé !\n\nRéservation enregistrée pour ${driverCalendars[driverId].name} (${driverCalendars[driverId].vehicle}).\nMontant débité : ${currencyFormatter.format(currentPricing.total)}\nRéférence paiement : ${paymentResult.transactionId}.\n\nUn email de confirmation vous sera envoyé sous peu.`);

            reservationForm.reset();
            pickupLocation = null;
            dropoffLocation = null;
            distanceField.value = '';
            distanceField.placeholder = 'En attente du calcul...';
            distanceMetersField.value = '';
            durationField.value = '';
            durationField.placeholder = 'En attente du calcul...';
            durationSecondsField.value = '';
            currentPricing = { total: null, rule: null, distanceKm: null, weekend: false };
            pricingSlot.textContent = '--';
            pricingPerKm.textContent = '--';
            pricingDistance.textContent = '--';
            pricingTotal.textContent = '--';
            calendarStatus.classList.remove('available', 'unavailable');
            calendarStatus.textContent = 'Sélectionnez un chauffeur puis une date de prise en charge pour vérifier sa disponibilité.';
        });

        function enforceMinimumDate() {
            const minDate = new Date();
            minDate.setHours(minDate.getHours() + 24);
            dateField.min = minDate.toISOString().slice(0, 16);
        }

        enforceMinimumDate();
        updateCalendarStatus();
        updatePricingSummary();
        syncDriverCalendars();
        loadGoogleMapsScript();
    </script>
</body>
</html>
